#!/usr/bin/env python
# coding: utf-8

# In[1]:


#

import os
import csv

directory = r"C:\Users\jinca\Desktop\Field-API"
output_folder = r"C:\Users\jinca\Desktop\Field-API_Compiled"
output_file = os.path.join(output_folder, "Field-API_Compiled.csv")

# Create the output folder if it doesn't exist
os.makedirs(output_folder, exist_ok=True)

# Top row values
top_row_values = [
    '900.8136649', '904.7187977', '909.9188285', '913.8137419', '917.7042757', '921.5904297', '925.4722041',
    '929.3495988', '933.2226138', '937.091249', '942.2426166', '946.1010326', '949.9550689', '953.8047255',
    '957.6500024', '961.4908996', '965.3274171', '969.1595549', '972.9873131', '978.0841777', '981.9017166',
    '985.7148757', '989.5236552', '993.3280549', '997.128075', '1000.923715', '1004.714976', '1009.763177',
    '1013.544219', '1017.32088', '1021.093162', '1024.861065', '1028.624587', '1032.38373', '1036.138493',
    '1039.888877', '1044.882576', '1048.62274', '1052.358524', '1056.089929', '1059.816954', '1063.5396',
    '1067.257865', '1070.971752', '1075.916787', '1079.620454', '1083.319741', '1087.014648', '1090.705176',
    '1094.391324', '1098.073092', '1101.750481', '1105.423489', '1110.314022', '1113.976811', '1117.635221',
    '1121.289252', '1124.938902', '1128.584173', '1132.225064', '1135.861576', '1140.703445', '1144.329737',
    '1147.951649', '1151.569182', '1155.182335', '1158.791109', '1162.395502', '1165.995516', '1169.59115',
    '1174.378517', '1177.963932', '1181.544967', '1185.121623', '1188.693899', '1192.261795', '1195.825311',
    '1199.384448', '1204.123151', '1207.672069', '1211.216606', '1214.756765', '1218.292543', '1221.823942',
    '1225.350961', '1228.8736', '1232.39186', '1237.07606', '1240.5841', '1244.087761', '1247.587042',
    '1251.081943', '1254.572465', '1258.058607', '1261.540369', '1266.175906', '1269.647449', '1273.114612',
    '1276.577396', '1280.0358', '1283.489824', '1286.939468', '1290.384733', '1293.825618', '1298.406652',
    '1301.837318', '1305.263604', '1308.68551', '1312.103037', '1315.516184', '1318.924951', '1322.329339',
    '1326.86171', '1330.255878', '1333.645666', '1337.031075', '1340.412105', '1343.788754', '1347.161024',
    '1350.528914', '1353.892425', '1358.370292', '1361.723584', '1365.072495', '1368.417027', '1371.757179',
    '1375.092951', '1378.424344', '1381.751357', '1385.07399', '1389.497355', '1392.809769', '1396.117804',
    '1399.421458', '1402.720733', '1406.015628', '1409.306144', '1412.59228', '1416.966981', '1420.242898',
    '1423.514435', '1426.781592', '1430.04437', '1433.302767', '1436.556785', '1439.806424', '1443.051682',
    '1447.371881', '1450.606921', '1453.83758', '1457.06386', '1460.285761', '1463.503281', '1466.716422',
    '1469.925183', '1474.196719', '1477.395261', '1480.589423', '1483.779206', '1486.964609', '1490.145632',
    '1493.322275', '1496.494539', '1499.662423', '1503.879456', '1507.03712', '1510.190406', '1513.339311',
    '1516.483837', '1519.623983', '1522.759749', '1525.891136', '1530.059505', '1533.180672', '1536.29746',
    '1539.409868', '1542.517896', '1545.621545', '1548.720814', '1551.815703', '1554.906212', '1559.020079',
    '1562.100369', '1565.176279', '1568.24781', '1571.314961', '1574.377733', '1577.436124', '1580.490136',
    '1584.55534', '1587.599132', '1590.638545', '1593.673579', '1596.704232', '1599.730506', '1602.752401',
    '1605.769915', '1608.78305', '1612.79375', '1615.796666', '1618.795202', '1621.789358', '1624.779134',
    '1627.764531', '1630.745548', '1633.722186', '1637.684223', '1640.650641', '1643.612679', '1646.570338',
    '1649.523617', '1652.472516', '1655.417036', '1658.357176', '1661.292936', '1665.20047', '1668.126011',
    '1671.047173', '1673.963954', '1676.876356', '1679.784378', '1682.688021', '1685.587283', '1689.446154',
    '1692.335198', '1695.219862', '1698.100146', '1700.97605'
]

# Write the top row values to the output file
with open(output_file, 'w', newline='') as file:
    writer = csv.writer(file)
    writer.writerow([''] + top_row_values)  # Add an empty cell for the first column

# Process each CSV file in the directory
for filename in os.listdir(directory):
    if filename.endswith('.csv'):
        file_path = os.path.join(directory, filename)
        with open(file_path, 'r') as file:
            reader = csv.reader(file)
            data = list(reader)

        # Extract column B and remove other columns
        column_b = [row[1] for row in data]

        # Remove top 29 rows
        column_b = column_b[29:]

        # Transpose the column into a row
        row_data = [filename] + column_b

        # Append the row data to the output file
        with open(output_file, 'a', newline='') as file:
            writer = csv.writer(file)
            writer.writerow(row_data)


# In[ ]:




